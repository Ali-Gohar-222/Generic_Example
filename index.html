<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KD Tree Visualization</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background: #0a0a0a;
            color: #00ff41;
        }
        .container {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        .canvas-area {
            flex: 1;
            background: #111;
            border: 2px solid #00ff41;
            border-radius: 8px;
            padding: 20px;
        }
        canvas {
            background: #000;
            border: 1px solid #333;
            display: block;
            margin: 0 auto;
        }
        .tree-area {
            flex: 1;
            background: #111;
            border: 2px solid #00ff41;
            border-radius: 8px;
            padding: 20px;
        }
        .controls {
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #00ff41;
            color: #000;
            border: none;
            padding: 12px 24px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin: 0 10px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        button:hover {
            background: #00cc33;
        }
        button:disabled {
            background: #333;
            color: #666;
            cursor: not-allowed;
        }
        .step-info {
            background: #1a1a1a;
            padding: 15px;
            margin: 20px 0;
            border-left: 4px solid #00ff41;
            font-size: 14px;
        }
        h2 {
            color: #00ff41;
            text-align: center;
            margin-bottom: 20px;
        }
        .legend {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 15px 0;
            font-size: 12px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .legend-box {
            width: 20px;
            height: 20px;
            border: 2px solid #00ff41;
        }
        pre {
            background: #000;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.6;
        }
    </style>
</head>
<body>
    <h2>KD TREE: STEP-BY-STEP CONSTRUCTION</h2>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-box" style="background: #ff0000;"></div>
            <span>X-axis split (vertical)</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: #0000ff;"></div>
            <span>Y-axis split (horizontal)</span>
        </div>
        <div class="legend-item">
            <div class="legend-box" style="background: #00ff41;"></div>
            <span>Points</span>
        </div>
    </div>

    <div class="controls">
        <button id="prevBtn">← Previous</button>
        <button id="nextBtn">Next →</button>
        <button id="resetBtn">Reset</button>
    </div>

    <div class="step-info" id="stepInfo"></div>

    <div class="container">
        <div class="canvas-area">
            <h2>Space Partition</h2>
            <canvas id="canvas" width="400" height="400"></canvas>
        </div>
        <div class="tree-area">
            <h2>Tree Structure</h2>
            <pre id="treeDisplay"></pre>
        </div>
    </div>

    <script>
        const points = [
            {x: 30, y: 40, label: '(30,40)'},
            {x: 5, y: 25, label: '(5,25)'},
            {x: 10, y: 55, label: '(10,55)'},
            {x: 70, y: 70, label: '(70,70)'},
            {x: 50, y: 30, label: '(50,30)'},
            {x: 35, y: 90, label: '(35,90)'}
        ];

        const steps = [
            {
                desc: "STEP 0: Initial 6 points in 2D space",
                lines: [],
                tree: "No splits yet\nAll points: (30,40), (5,25), (10,55), (70,70), (50,30), (35,90)"
            },
            {
                desc: "STEP 1: Split by X-axis at median (30,40)\nLeft: x < 30 | Right: x ≥ 30",
                lines: [{x: 30, type: 'v', color: '#ff0000'}],
                tree: "         (30,40) [X]\n        /          \\\n   LEFT (2)      RIGHT (3)\n  x < 30         x ≥ 30"
            },
            {
                desc: "STEP 2: Left subtree → Split by Y-axis at (5,25)\nAbove: y ≥ 25",
                lines: [
                    {x: 30, type: 'v', color: '#ff0000'},
                    {y: 25, x1: 0, x2: 30, type: 'h', color: '#0000ff'}
                ],
                tree: "         (30,40) [X]\n        /          \\\n    (5,25) [Y]    RIGHT (3)\n        \\\n      (10,55)"
            },
            {
                desc: "STEP 3: Right subtree → Split by Y-axis at (35,90)",
                lines: [
                    {x: 30, type: 'v', color: '#ff0000'},
                    {y: 25, x1: 0, x2: 30, type: 'h', color: '#0000ff'},
                    {y: 90, x1: 30, x2: 100, type: 'h', color: '#0000ff'}
                ],
                tree: "         (30,40) [X]\n        /          \\\n    (5,25) [Y]    (35,90) [Y]\n        \\          /      \\\n      (10,55)  BELOW    (70,70)\n               y < 90"
            },
            {
                desc: "STEP 4: Final split by X-axis at (50,30)\nComplete KD tree constructed!",
                lines: [
                    {x: 30, type: 'v', color: '#ff0000'},
                    {y: 25, x1: 0, x2: 30, type: 'h', color: '#0000ff'},
                    {y: 90, x1: 30, x2: 100, type: 'h', color: '#0000ff'},
                    {x: 50, y1: 0, y2: 90, type: 'v', color: '#ff0000'}
                ],
                tree: "         (30,40) [X]\n        /          \\\n    (5,25) [Y]    (35,90) [Y]\n        \\          /      \\\n      (10,55)  (50,30) [X]  (70,70)\n"
            }
        ];

        let currentStep = 0;
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const scale = 4;

        function drawGrid() {
            ctx.strokeStyle = '#222';
            ctx.lineWidth = 1;
            for (let i = 0; i <= 100; i += 10) {
                ctx.beginPath();
                ctx.moveTo(i * scale, 0);
                ctx.lineTo(i * scale, 400);
                ctx.stroke();
                ctx.beginPath();
                ctx.moveTo(0, 400 - i * scale);
                ctx.lineTo(400, 400 - i * scale);
                ctx.stroke();
            }
        }

        function drawPoint(p) {
            ctx.fillStyle = '#00ff41';
            ctx.beginPath();
            ctx.arc(p.x * scale, 400 - p.y * scale, 5, 0, Math.PI * 2);
            ctx.fill();
            ctx.fillStyle = '#00ff41';
            ctx.font = '11px Courier New';
            ctx.fillText(p.label, p.x * scale + 8, 400 - p.y * scale - 8);
        }

        function drawLine(line) {
            ctx.strokeStyle = line.color;
            ctx.lineWidth = 2;
            ctx.beginPath();
            if (line.type === 'v') {
                ctx.moveTo(line.x * scale, line.y1 ? 400 - line.y1 * scale : 0);
                ctx.lineTo(line.x * scale, line.y2 ? 400 - line.y2 * scale : 400);
            } else {
                ctx.moveTo(line.x1 * scale, 400 - line.y * scale);
                ctx.lineTo(line.x2 * scale, 400 - line.y * scale);
            }
            ctx.stroke();
        }

        function render() {
            ctx.clearRect(0, 0, 400, 400);
            drawGrid();
            
            steps[currentStep].lines.forEach(line => drawLine(line));
            points.forEach(p => drawPoint(p));
            
            document.getElementById('stepInfo').textContent = steps[currentStep].desc;
            document.getElementById('treeDisplay').textContent = steps[currentStep].tree;
            
            document.getElementById('prevBtn').disabled = currentStep === 0;
            document.getElementById('nextBtn').disabled = currentStep === steps.length - 1;
        }

        document.getElementById('nextBtn').addEventListener('click', () => {
            if (currentStep < steps.length - 1) {
                currentStep++;
                render();
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            if (currentStep > 0) {
                currentStep--;
                render();
            }
        });

        document.getElementById('resetBtn').addEventListener('click', () => {
            currentStep = 0;
            render();
        });

        render();
    </script>
</body>
</html>
